(this["webpackJsonpinstructor-app"]=this["webpackJsonpinstructor-app"]||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n(2),c=n.n(a),s=n(3),u=n(4),i=n(0),o=n(1),l=n.n(o),p=n(11),f=n.n(p),d=n(7);function j(e){var t=e.students,n=Object(o.useState)(t),a=Object(u.a)(n,2),c=a[0],s=a[1];return Object(i.jsxs)("div",{className:"student-list-container",children:[Object(i.jsx)(v,Object(r.a)(Object(r.a)({},e),{},{setDisplayedStudents:s})),Object(i.jsx)("input",{type:"text",placeholder:"Filter",onChange:function(e){var n=e.target.value.split(" "),r=t.filter((function(e){var t=e.first,r=e.last;return n.every((function(e){var n=new RegExp(e,"i");return t.match(n)||r.match(n)}))}));s(r)}}),Object(i.jsx)("ul",{className:"student-list",children:c.map(b.bind(null,e))})]})}function v(e){var t=e.students,n=e.setStudents,r=e.setDisplayedStudents,a=function(){var e=Object(s.a)(c.a.mark((function e(){var a,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat("https://secret-plains-66902.herokuapp.com/api","/students"),e.next=3,fetch(a,{headers:{authorization:"testingpw"}});case 3:if(!(s=e.sent).ok){e.next=18;break}return e.prev=5,e.next=8,s.json();case 8:u=e.sent.map((function(e){return t.find((function(t){var n=t.first,r=t.last;return n===e.first&&r===e.last}))||e})),n(u),r(u),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:e.next=19;break;case 18:console.log("HTTP error, status = "+s.status);case 19:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)("button",{className:"refresh-students",onClick:a,children:"Refresh"})}function b(e,t){var n=e.students,r=e.setStudents,a=t.first,c=t.last,s=t.active;return Object(i.jsxs)("li",{children:[h(a)," ",h(c)," ",Object(i.jsx)("input",{type:"checkbox",name:"active",id:"".concat(a,"_").concat(c,"-active"),defaultChecked:!!s,onChange:function(){t.active=!s,r(Object(d.a)(n))}})]},"".concat(a," ").concat(c))}function h(e){return e.replace(/^./,(function(e){return e.toUpperCase()}))}var z=n(10);function m(e){var t=e.data,n=t.size,r=function(e){var t=e.size,n=e.cages,r=e.work;return Array(Math.pow(t,2)).fill(null).map((function(){for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];var s=a[1],u=Math.floor(s/t),i=s%t,o=w({col:u,row:i}),l=r.find(o),p=n.find((function(e){return e.squares.find(o)})),f=x({col:u,row:i},p),d=p.squares.every((function(e){return e.col>=u&&(e.row>=i||e.col>u)})),j=d?p.result:null,v=d?p.operation:null,b=l?l.value:null;return{col:u,row:i,value:b,neighbors:f,result:j,operation:v}}))}(t);return Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"puzzle-container",size:n,children:Object(i.jsx)("div",{className:"grid-container",size:n,children:r.map(O)})})})}function O(e){var t="calcudoku-square "+e.neighbors.join(" ");return Object(i.jsxs)("div",{className:t,children:[Object(i.jsxs)("div",{className:"cage-indicator",children:[e.result,e.operation]}),Object(i.jsx)("input",{type:"number",value:e.value||"",disabled:!0})]})}function x(e,t){var n=[],r={"n-up":{col:e.col-1,row:e.row},"n-down":{col:e.col+1,row:e.row},"n-left":{col:e.col,row:e.row-1},"n-right":{col:e.col,row:e.row+1}};for(var a in r){var c=w(r[a]);t.squares.find(c)&&n.push(a)}return n}function w(e){var t=e.col,n=e.row;return function(e){return e.col===t&&e.row===n}}function g(e){var t=e.data,n=t.description,r=t.work;return Object(i.jsxs)("div",{className:"logic",children:[Object(i.jsx)("p",{className:"description",children:n}),Object(i.jsx)("p",{className:"work",children:r})]})}var k={calcudoku:function(e){return Object(i.jsx)(m,{data:e})},logic:function(e){return Object(i.jsx)(g,{data:e})}},y={activepuzzle:!0,puzzleName:"calcudoku",puzzleId:"4x4beginner1"};function N(e){var t=Object(o.useState)(new Map),n=Object(u.a)(t,2),a=n[0],l=n[1],p=Object(o.useState)(new Map),f=Object(u.a)(p,2),j=f[0],v=f[1],b=Object(o.useState)(new Map),h=Object(u.a)(b,2),m=h[0],O=h[1],x=Object(o.useMemo)((function(){return e.students.filter((function(e){return e.active}))}),[e.students]);Object(o.useEffect)((function(){v((function(t){var n=new Map(t);return e.students.forEach((function(e){n.has(e)||n.set(e,y)})),n}))}),[e.students,v]);var w=Object(o.useCallback)(function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,a,s,u,i,o,l,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.first,r=t.last,a=j.get(t),s=a.activepuzzle,u=a.puzzleName,i=a.puzzleId,o=s?"activepuzzle":"".concat(u,"/").concat(i),l="https://secret-plains-66902.herokuapp.com/api"+"/students/".concat(n,"_").concat(r,"/").concat(o),e.next=6,fetch(l,{headers:{authorization:"testingpw"}});case 6:return p=e.sent,e.next=9,p.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[j]),g=Object(o.useCallback)(function(){var e=Object(s.a)(c.a.mark((function e(t){var n,a,s,u,i,o,l,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.first,a=t.last,s="https://secret-plains-66902.herokuapp.com/api"+"/students/".concat(n,"_").concat(a,"/activepuzzle"),e.next=4,fetch(s,{headers:{authorization:"testingpw"}});case 4:return u=e.sent,e.next=7,u.json();case 7:if(i=e.sent,o=i.puzzleName,l=i.puzzleId,p=Object(z.a)(i,["puzzleName","puzzleId"]),o){e.next=13;break}return e.abrupt("return");case 13:O((function(e){var n=e.get(t)||{},a=n[o]||{},c=a[l]||[];if(!c[0]||JSON.stringify(Object(r.a)({puzzleId:l},p))!==JSON.stringify(c[0].data)){a[l]=[{data:Object(r.a)({puzzleId:l},p),timestamp:Date.now()}].concat(Object(d.a)(c)),n[o]=a;var s=new Map(e);return s.set(t,n),s}return e}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[O]),N=Object(o.useCallback)(Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(x.map(function(){var e=Object(s.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(t),e.next=3,w(t);case 3:return n=e.sent,e.abrupt("return",[t,n]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:t=e.sent,l((function(e){var n=new Map(e);return t.forEach((function(e){return n.set.apply(n,Object(d.a)(e))})),n})),console.log("refreshed");case 5:case"end":return e.stop()}}),e)}))),[x,l,w,g]);Object(o.useEffect)((function(){N();var e=setInterval(N,1e3);return function(){return clearInterval(e)}}),[N]);var S=function(t,n,a){var c=Object(r.a)({},j.get(t));c[n]=a,"puzzleName"===n&&(c.puzzleId=e.puzzleDirectory[a][0]);var s=new Map(j);s.set(t,c),v(s)},C=function(e){var t=a.get(e)||{},n=t.puzzleName,r=Object(z.a)(t,["puzzleName"]),c=k[n];return c?c(r):null},M=function(e){var t=m.get(e);if(!t)return null;var n=e.first,r=e.last,a=Object.keys(t).flatMap((function(e){return Object.keys(t[e]).map((function(n){var r=t[e][n][0],a=r.data.puzzleId,c=r.timestamp;return{puzzleName:e,puzzleId:a,timestamp:c}}))})).sort((function(e,t){return e.timestamp>t.timestamp?-1:1}));return Object(i.jsx)("select",{name:"history-select",className:"history-select",id:"history-".concat(n,"-").concat(r),onChange:function(t){var n=JSON.parse(t.target.value),r=n.puzzleName,a=n.puzzleId;S(e,"puzzleName",r),S(e,"puzzleId",a)},children:a.map((function(e){var t=e.puzzleName,n=e.puzzleId,r=e.timestamp,a=new Date(r).toLocaleTimeString();return Object(i.jsxs)("option",{value:JSON.stringify({puzzleName:t,puzzleId:n}),children:[n," ",a]})}))})},D=function(t){var n=e.puzzleDirectory,r=j.get(t),a=r.puzzleName,c=r.puzzleId,s=a?n[a]:[];return Object(i.jsxs)("div",{className:"puzzle-select",children:[Object(i.jsx)("select",{name:"type-select",id:"type-select",value:a,onChange:function(e){return S(t,"puzzleName",e.target.value)},children:Object.keys(n).map((function(e){return Object(i.jsx)("option",{value:e,children:e})}))}),Object(i.jsx)("select",{name:"instance-select",id:"instance-select",value:c,onChange:function(e){return S(t,"puzzleId",e.target.value)},children:s.map((function(e){return Object(i.jsx)("option",{value:e,children:e})}))}),M(t)]})},E=function(e){var t=m.get(e)||{};return Object.keys(t).some((function(e){return Object.keys(t[e]).some((function(n){var r=t[e][n][0].timestamp;return Date.now()-r<6e4}))}))};return Object(i.jsx)("ul",{className:"puzzle-display",children:x.map((function(e){var t=e.first,n=e.last,r=j.get(e),a=r?r.activepuzzle:null;return Object(i.jsxs)("li",{children:[Object(i.jsxs)("div",{className:"student-header",children:[Object(i.jsxs)("div",{className:"student-name",children:[Object(i.jsxs)("span",{className:"name",children:[I(t)," ",I(n)]}),Object(i.jsx)("span",{className:"activity-indicator",children:E(e)?null:"Inactive"})]}),Object(i.jsxs)("div",{children:["Show Active Puzzle:",Object(i.jsx)("input",{type:"checkbox",name:"active",id:"".concat(t,"_").concat(n,"-active"),checked:!!a,onChange:function(){return S(e,"activepuzzle",!a)}})]}),a?null:D(e)]}),C(e)]},"".concat(t,"_").concat(n))}))})}function I(e){return e.replace(/^./,(function(e){return e.toUpperCase()}))}n(18);function S(){var e=Object(o.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],l=Object(o.useState)({calcudoku:[],logic:[]}),p=Object(u.a)(l,2),f=p[0],d=p[1];return Object(o.useEffect)((function(){Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(Object.keys(f).map(function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://secret-plains-66902.herokuapp.com/api","/puzzles/").concat(t),e.next=3,fetch(n,{headers:{authorization:"testingpw"}});case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:f[t]=e.sent.map((function(e){return e.instance})),e.next=11;break;case 10:console.log("Http error: ".concat(r.status));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:d(Object(r.a)({},f)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()}),[]),Object(i.jsxs)("div",{className:"app",children:[Object(i.jsx)(j,{students:n,setStudents:a}),Object(i.jsx)(N,{students:n,puzzleDirectory:f})]})}f.a.render(Object(i.jsx)(l.a.StrictMode,{children:Object(i.jsx)(S,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.64604a62.chunk.js.map